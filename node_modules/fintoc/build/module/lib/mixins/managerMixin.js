var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
import { resourceAll, resourceCreate, resourceDelete, resourceGet, resourceUpdate, } from '../resourceHandlers';
import { canRaiseHTTPError, getResourceClass } from '../utils';
export class ManagerMixin {
    static resource;
    static methods;
    #path;
    #handlers;
    _client;
    constructor(path, client) {
        this.#path = path;
        this._client = client;
        this.#handlers = {
            update: this.postUpdateHandler.bind(this),
            delete: this.postDeleteHandler.bind(this),
        };
    }
    get #originatingClass() {
        return this.constructor;
    }
    list(args) {
        if (!this.#originatingClass.methods.includes('list')) {
            throw new TypeError(`${this.#originatingClass.name}.list is not a valid function of of this manager`);
        }
        return this._list(args);
    }
    all(args) {
        console.warn("Warning: The 'all()' method is deprecated. Please use 'list()' instead.");
        if (!this.#originatingClass.methods.includes('list')) {
            throw new TypeError(`${this.#originatingClass.name}.all is not a valid function of of this manager`);
        }
        return this._list(args);
    }
    /**
     * Return an instance of the resource being handled by the manager.
     *
     * @param identifier - The identifier of the resource to get
     * @param args - Object with the arguments to filter the query, using the API parameters
     * @returns An instance of the resource
     */
    get(identifier, args) {
        if (!this.#originatingClass.methods.includes('get')) {
            throw new TypeError(`${this.#originatingClass.name}.get is not a valid function of of this manager`);
        }
        return this._get(identifier, args);
    }
    /**
     * Create an instance of the resource being handled by the manager.
     *
     * @param args - Data to be passed for the object creation, as specified by the API
     * @returns The created instance of the object
     */
    create(args) {
        if (!this.#originatingClass.methods.includes('create')) {
            throw new TypeError(`${this.#originatingClass.name}.create is not a valid function of of this manager`);
        }
        return this._create(args);
    }
    /**
     * Update an instance of the resource being handled by the manager.
     *
     * @param identifier - The identifier of the resource to update
     * @param args - Data to be passed for the object to be updated with, as specified by the API
     * @returns The updated instance of the object
     */
    update(identifier, args) {
        if (!this.#originatingClass.methods.includes('update')) {
            throw new TypeError(`${this.#originatingClass.name}.update is not a valid function of of this manager`);
        }
        return this._update(identifier, args);
    }
    /**
     * Delete an instance of the resource being handled by the manager.
     *
     * @param identifier - The identifier of the resource to delete
     * @param args - Object with the arguments to filter the query, using the API parameters
     * @returns The identifier of the deleted object
     */
    delete(identifier, args) {
        if (!this.#originatingClass.methods.includes('delete')) {
            throw new TypeError(`${this.#originatingClass.name}.delete is not a valid function of of this manager`);
        }
        return this._delete(identifier, args);
    }
    async _list(args) {
        const innerArgs = args || {};
        const klass = await getResourceClass(this.#originatingClass.resource);
        const objects = await resourceAll(this._client, this.buildPath(innerArgs), klass, this.#handlers, this.#originatingClass.methods, innerArgs);
        return this.postListHandler(objects, innerArgs);
    }
    async _get(identifier, args) {
        const innerArgs = args || {};
        const klass = await getResourceClass(this.#originatingClass.resource);
        const object = await resourceGet(this._client, this.buildPath(innerArgs), identifier, klass, this.#handlers, this.#originatingClass.methods, innerArgs);
        return this.postGetHandler(object, identifier, innerArgs);
    }
    async _create(args) {
        const innerArgs = args || {};
        const { path_ = this.buildPath(), idempotency_key: idempotencyKey } = innerArgs;
        const klass = await getResourceClass(this.#originatingClass.resource);
        const object = await resourceCreate(this._client, path_.toString(), klass, this.#handlers, this.#originatingClass.methods, innerArgs, idempotencyKey?.toString());
        return this.postCreateHandler(object, innerArgs);
    }
    async _update(identifier, args) {
        const innerArgs = args || {};
        const { path_ } = innerArgs;
        const klass = await getResourceClass(this.#originatingClass.resource);
        const object = await resourceUpdate(this._client, this.buildPath(innerArgs), identifier, klass, this.#handlers, this.#originatingClass.methods, innerArgs, path_?.toString());
        return this.postUpdateHandler(object, identifier, innerArgs);
    }
    async _delete(identifier, args) {
        const innerArgs = args || {};
        await resourceDelete(this._client, this.buildPath(innerArgs), identifier, this.#handlers);
        return this.postDeleteHandler(identifier, innerArgs);
    }
    /* eslint-disable class-methods-use-this, @typescript-eslint/no-unused-vars */
    postListHandler(objects, args) {
        return objects;
    }
    postGetHandler(object, identifier, args) {
        return object;
    }
    postCreateHandler(object, args) {
        return object;
    }
    postUpdateHandler(object, identifier, args) {
        return object;
    }
    postDeleteHandler(identifier, args) {
        return identifier;
    }
    buildPath(args) {
        let path = this.#path;
        for (const [key, value] of Object.entries(args || {})) {
            path = path.replace(`{${key}}`, value.toString());
        }
        return path;
    }
}
__decorate([
    canRaiseHTTPError
], ManagerMixin.prototype, "_list", null);
__decorate([
    canRaiseHTTPError
], ManagerMixin.prototype, "_get", null);
__decorate([
    canRaiseHTTPError
], ManagerMixin.prototype, "_create", null);
__decorate([
    canRaiseHTTPError
], ManagerMixin.prototype, "_update", null);
__decorate([
    canRaiseHTTPError
], ManagerMixin.prototype, "_delete", null);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFuYWdlck1peGluLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9taXhpbnMvbWFuYWdlck1peGluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUdBLE9BQU8sRUFDTCxXQUFXLEVBQ1gsY0FBYyxFQUNkLGNBQWMsRUFDZCxXQUFXLEVBQ1gsY0FBYyxHQUNmLE1BQU0scUJBQXFCLENBQUM7QUFDN0IsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGdCQUFnQixFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRS9ELE1BQU0sT0FBZ0IsWUFBWTtJQUNoQyxNQUFNLENBQUMsUUFBUSxDQUFTO0lBQ3hCLE1BQU0sQ0FBQyxPQUFPLENBQVc7SUFFekIsS0FBSyxDQUFTO0lBQ2QsU0FBUyxDQUFpQztJQUVoQyxPQUFPLENBQVM7SUFFMUIsWUFBWSxJQUFZLEVBQUUsTUFBYztRQUN0QyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNsQixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztRQUN0QixJQUFJLENBQUMsU0FBUyxHQUFHO1lBQ2YsTUFBTSxFQUFFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQ3pDLE1BQU0sRUFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztTQUMxQyxDQUFDO0lBQ0osQ0FBQztJQUVELElBQUksaUJBQWlCO1FBQ25CLE9BQU8sSUFBSSxDQUFDLFdBQWtELENBQUM7SUFDakUsQ0FBQztJQVdELElBQUksQ0FBQyxJQUF3QjtRQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQztZQUNyRCxNQUFNLElBQUksU0FBUyxDQUFDLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksa0RBQWtELENBQUMsQ0FBQztRQUN4RyxDQUFDO1FBQ0QsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFZRCxHQUFHLENBQUMsSUFBd0I7UUFDMUIsT0FBTyxDQUFDLElBQUksQ0FBQyx5RUFBeUUsQ0FBQyxDQUFDO1FBQ3hGLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDO1lBQ3JELE1BQU0sSUFBSSxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxpREFBaUQsQ0FBQyxDQUFDO1FBQ3ZHLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNILEdBQUcsQ0FBQyxVQUFrQixFQUFFLElBQXdCO1FBQzlDLElBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ3BELE1BQU0sSUFBSSxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxpREFBaUQsQ0FBQyxDQUFDO1FBQ3ZHLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNILE1BQU0sQ0FBQyxJQUF3QjtRQUM3QixJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztZQUN2RCxNQUFNLElBQUksU0FBUyxDQUFDLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksb0RBQW9ELENBQUMsQ0FBQztRQUMxRyxDQUFDO1FBQ0QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFFRDs7Ozs7O09BTUc7SUFDSCxNQUFNLENBQUMsVUFBa0IsRUFBRSxJQUF3QjtRQUNqRCxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztZQUN2RCxNQUFNLElBQUksU0FBUyxDQUFDLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksb0RBQW9ELENBQUMsQ0FBQztRQUMxRyxDQUFDO1FBQ0QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0gsTUFBTSxDQUFDLFVBQWtCLEVBQUUsSUFBd0I7UUFDakQsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7WUFDdkQsTUFBTSxJQUFJLFNBQVMsQ0FBQyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLG9EQUFvRCxDQUFDLENBQUM7UUFDMUcsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQUdlLEFBQU4sS0FBSyxDQUFDLEtBQUssQ0FDbkIsSUFBd0I7UUFFeEIsTUFBTSxTQUFTLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM3QixNQUFNLEtBQUssR0FBRyxNQUFNLGdCQUFnQixDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN0RSxNQUFNLE9BQU8sR0FBRyxNQUFNLFdBQVcsQ0FDL0IsSUFBSSxDQUFDLE9BQU8sRUFDWixJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxFQUN6QixLQUFLLEVBQ0wsSUFBSSxDQUFDLFNBQVMsRUFDZCxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxFQUM5QixTQUFTLENBQ1YsQ0FBQztRQUNGLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDbEQsQ0FBQztJQUdlLEFBQU4sS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFrQixFQUFFLElBQXdCO1FBQy9ELE1BQU0sU0FBUyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUM7UUFDN0IsTUFBTSxLQUFLLEdBQUcsTUFBTSxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxXQUFXLENBQzlCLElBQUksQ0FBQyxPQUFPLEVBQ1osSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsRUFDekIsVUFBVSxFQUNWLEtBQUssRUFDTCxJQUFJLENBQUMsU0FBUyxFQUNkLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLEVBQzlCLFNBQVMsQ0FDVixDQUFDO1FBQ0YsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDNUQsQ0FBQztJQUdlLEFBQU4sS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUF3QjtRQUM5QyxNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQzdCLE1BQU0sRUFBRSxLQUFLLEdBQUcsSUFBSSxDQUFDLFNBQVMsRUFBRSxFQUFFLGVBQWUsRUFBRSxjQUFjLEVBQUUsR0FBRyxTQUFTLENBQUM7UUFDaEYsTUFBTSxLQUFLLEdBQUcsTUFBTSxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxjQUFjLENBQ2pDLElBQUksQ0FBQyxPQUFPLEVBQ1osS0FBSyxDQUFDLFFBQVEsRUFBRSxFQUNoQixLQUFLLEVBQ0wsSUFBSSxDQUFDLFNBQVMsRUFDZCxJQUFJLENBQUMsaUJBQWlCLENBQUMsT0FBTyxFQUM5QixTQUFTLEVBQ1QsY0FBYyxFQUFFLFFBQVEsRUFBRSxDQUMzQixDQUFDO1FBQ0YsT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFHZSxBQUFOLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBa0IsRUFBRSxJQUF3QjtRQUNsRSxNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQzdCLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxTQUFTLENBQUM7UUFDNUIsTUFBTSxLQUFLLEdBQUcsTUFBTSxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDdEUsTUFBTSxNQUFNLEdBQUcsTUFBTSxjQUFjLENBQ2pDLElBQUksQ0FBQyxPQUFPLEVBQ1osSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsRUFDekIsVUFBVSxFQUNWLEtBQUssRUFDTCxJQUFJLENBQUMsU0FBUyxFQUNkLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLEVBQzlCLFNBQVMsRUFDVCxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQ2xCLENBQUM7UUFDRixPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUUsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQy9ELENBQUM7SUFHZSxBQUFOLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBa0IsRUFBRSxJQUF3QjtRQUNsRSxNQUFNLFNBQVMsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQzdCLE1BQU0sY0FBYyxDQUNsQixJQUFJLENBQUMsT0FBTyxFQUNaLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLEVBQ3pCLFVBQVUsRUFDVixJQUFJLENBQUMsU0FBUyxDQUNmLENBQUM7UUFDRixPQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVELDhFQUE4RTtJQUNwRSxlQUFlLENBQ3ZCLE9BQXNELEVBQ3RELElBQXVCO1FBRXZCLE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7SUFFUyxjQUFjLENBQUMsTUFBb0IsRUFBRSxVQUFrQixFQUFFLElBQXVCO1FBQ3hGLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFUyxpQkFBaUIsQ0FBQyxNQUFvQixFQUFFLElBQXVCO1FBQ3ZFLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFUyxpQkFBaUIsQ0FBQyxNQUFvQixFQUFFLFVBQWtCLEVBQUUsSUFBdUI7UUFDM0YsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVTLGlCQUFpQixDQUFDLFVBQWtCLEVBQUUsSUFBdUI7UUFDckUsT0FBTyxVQUFVLENBQUM7SUFDcEIsQ0FBQztJQUVTLFNBQVMsQ0FBQyxJQUF3QjtRQUMxQyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ3RCLEtBQUssTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQ3RELElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksR0FBRyxHQUFHLEVBQUUsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7UUFDcEQsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztDQUVGO0FBL0dpQjtJQURmLGlCQUFpQjt5Q0FlakI7QUFHZTtJQURmLGlCQUFpQjt3Q0FjakI7QUFHZTtJQURmLGlCQUFpQjsyQ0FlakI7QUFHZTtJQURmLGlCQUFpQjsyQ0FnQmpCO0FBR2U7SUFEZixpQkFBaUI7MkNBVWpCIn0=